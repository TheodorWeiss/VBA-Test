let
    t0 = #"Предыдущий шаг",

    // 1) Тип для ID (чтобы сортировка была числовая)
    t1 = Table.TransformColumnTypes(t0, {{"ID", Int64.Type}}),

    // 2) Флаг пустого Anbieter: пусто/null -> 1 (в конец), иначе 0
    t2 = Table.AddColumn(
        t1,
        "Anbieter_IsBlank",
        each if [Anbieter] = null or Text.Trim([Anbieter]) = "" then 1 else 0,
        Int64.Type
    ),

    // 3) Сортировка:
    //    - сначала по флагу (0 наверху, 1 внизу)
    //    - потом Anbieter по убыванию
    //    - потом ID по возрастанию
    t3 = Table.Sort(
        t2,
        {
            {"Anbieter_IsBlank", Order.Ascending},
            {"Anbieter", Order.Descending},
            {"ID", Order.Ascending}
        }
    ),

    // 4) Удаляем вспомогательный столбец
    t4 = Table.RemoveColumns(t3, {"Anbieter_IsBlank"})
in
    t4
