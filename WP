–û—Ç–ª–∏—á–Ω–æ, –∑–∞–¥–∞—á–∞ –ø–æ–Ω—è—Ç–Ω–∞ üëç
–ù—É–∂–Ω–æ:
	‚Ä¢	–µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω = krt
	‚Ä¢	–∏–ª–∏ –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω = msc
(–ø—Ä–æ–≤–µ—Ä—è–µ–º –≤ lowercase –∏ –±–µ–∑ —Ç–æ—á–∫–∏)

‚Üí —Ç–æ–≥–¥–∞ TokenNr = 0
‚Üí –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã —Å–¥–≤–∏–≥–∞—é—Ç—Å—è.

–í–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π –±–ª–æ–∫ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ —Ç–≤–æ–π —à–∞–≥ Add TokenRecords:

let
    t = [Tokens],
    n = List.Count(t),

    // –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω: lowercase + —É–±–∏—Ä–∞–µ–º —Ç–æ—á–∫—É
    firstNorm = 
        if n = 0 then "" 
        else Text.Lower(Text.Replace(t{0}, ".", "")),

    // —Å–ø–∏—Å–æ–∫ —Ç–æ–∫–µ–Ω–æ–≤ —Å –Ω—É–ª–µ–≤–æ–π –ø–æ–∑–∏—Ü–∏–µ–π
    zeroTokens = {"krt", "msc"},

    offset = if List.Contains(zeroTokens, firstNorm) then 1 else 0,

    recs =
        List.Transform(
            List.Positions(t),
            (i) =>
                [
                    Token = t{i},
                    TokenNr = 
                        if offset = 1 and i = 0 
                        then 0 
                        else i + 1 - offset,

                    TokenNrFromEnd = -(n - i)
                ]
        )
in
    recs


‚∏ª

–ß—Ç–æ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç

–ü—Ä–∏–º–µ—Ä:

Krt. msc loewen pils

‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç—Å—è –≤ krt
‚Üí –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–∞–µ—Ç 0
‚Üí msc —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è 1
‚Üí –¥–∞–ª—å—à–µ 2, 3‚Ä¶

–ü—Ä–∏–º–µ—Ä:

msc knorr fix

‚Üí msc ‚Üí 0
‚Üí knorr ‚Üí 1
‚Üí fix ‚Üí 2

–ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω –Ω–µ –∏–∑ —Å–ø–∏—Å–∫–∞ ‚Üí –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ.

‚∏ª

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –µ—â—ë –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:
—á—Ç–æ–±—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã—Ö –ø–æ–¥—Ä—è–¥ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä krt msc tray) –≤—Å–µ –ø–æ–ª—É—á–∞–ª–∏ 0, –∞ –Ω—É–º–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ —Å –ø–µ—Ä–≤–æ–≥–æ ‚Äú–Ω–∞—Å—Ç–æ—è—â–µ–≥–æ‚Äù —Å–ª–æ–≤–∞. –≠—Ç–æ —É–∂–µ –±—É–¥–µ—Ç –Ω–µ–º–Ω–æ–≥–æ —É–º–Ω–µ–µ üòâ
