–Ø—Å–Ω–∞ üëç –¢—ã —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã —Ç–æ–∫–µ–Ω Krt. / Krt, –µ—Å–ª–∏ –æ–Ω —Å—Ç–æ–∏—Ç –ø–µ—Ä–≤—ã–º, –Ω–µ —Å—á–∏—Ç–∞–ª—Å—è ‚Äú–ø–µ—Ä–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º –±—Ä–µ–Ω–¥–∞‚Äù. –¢–æ –µ—Å—Ç—å:
	‚Ä¢	–¥–ª—è –Ω–µ–≥–æ TokenNr = 0
	‚Ä¢	—Å–ª–µ–¥—É—é—â–∏–π —Ç–æ–∫–µ–Ω –¥–æ–ª–∂–µ–Ω —Å—Ç–∞—Ç—å TokenNr = 1, –¥–∞–ª—å—à–µ 2,3‚Ä¶

–≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –ø—Ä—è–º–æ –≤ —Ç–≤–æ—ë–º –±–ª–æ–∫–µ, –≥–¥–µ —Ç—ã —Å—Ç—Ä–æ–∏—à—å recs = List.Transform(...).

–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –¥–æ–ø–∏—Å–∞—Ç—å

–ó–∞–º–µ–Ω—è–µ—à—å –∫—É—Å–æ–∫ –≤–Ω—É—Ç—Ä–∏ each let ... –≤ —à–∞–≥–µ ‚ÄúAdd TokenRecords‚Äù –Ω–∞ —ç—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç (—è –æ—Å—Ç–∞–≤–∏–ª —Ç–≤–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –¥–æ–±–∞–≤–∏–ª —Ç–æ–ª—å–∫–æ offset –∏ –ª–æ–≥–∏–∫—É TokenNr):

let
    t = [Tokens],
    n = List.Count(t),

    // –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω = "krt" –∏–ª–∏ "krt." (–±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞) -> —Å–¥–≤–∏–≥–∞–µ–º –Ω—É–º–µ—Ä–∞—Ü–∏—é
    firstNorm = if n = 0 then "" else Text.Lower(Text.Trim(Text.TrimEnd(t{0}, "."))),
    offset = if firstNorm = "krt" then 1 else 0,

    recs =
        List.Transform(
            List.Positions(t),
            (i) =>
                [
                    Token = t{i},
                    TokenNr = if offset = 1 and i = 0 then 0 else (i + 1 - offset),
                    TokenNrFromEnd = -(n - i)
                ]
        )
in
    recs

–ö–∞–∫ —ç—Ç–æ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

–ü—Ä–∏–º–µ—Ä: Krt. coca cola 6x0,5l
	‚Ä¢	Krt. ‚Üí TokenNr = 0
	‚Ä¢	coca ‚Üí TokenNr = 1
	‚Ä¢	cola ‚Üí TokenNr = 2
	‚Ä¢	‚Ä¶

–ï—Å–ª–∏ Krt. –Ω–µ –ø–µ—Ä–≤—ã–π (—Ä–µ–¥–∫–æ, –Ω–æ –≤–¥—Ä—É–≥) ‚Äî –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ–º.

‚∏ª

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –µ—â—ë –∂—ë—Å—Ç—á–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–∂–µ Karton, Tray, Pack, Mp, Multipack) ‚Äî —Å–∫–∞–∂–∏, –∏ —è –¥–∞–º –≤–µ—Ä—Å–∏—é, –≥–¥–µ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å—Ç–æ–ø-—Å–ª–æ–≤ (–º–æ–∂–Ω–æ –ø—Ä—è–º–æ —Ç–∞–±–ª–∏—Ü–µ–π-—Å–ª–æ–≤–∞—Ä—ë–º).
