Option Explicit

Public Sub GetLatestMailAndSaveAttachments()
    Dim subjectPhrase As String
    subjectPhrase = "Wechsler KW"   ' <-- фраза в теме

    Dim targetFolder As String
    targetFolder = "H:\Wechsler\InboxDrop"  ' <-- папка для вложений (создай заранее)

    Dim olApp As Object, ns As Object, inbox As Object, items As Object
    Set olApp = CreateObject("Outlook.Application")
    Set ns = olApp.GetNamespace("MAPI")

    ' 6 = olFolderInbox
    Set inbox = ns.GetDefaultFolder(6)
    Set items = inbox.Items

    items.Sort "[ReceivedTime]", True  ' новые сверху

    Dim i As Long
    For i = 1 To items.Count
        If TypeName(items(i)) = "MailItem" Then
            Dim mail As Object
            Set mail = items(i)

            If InStr(1, mail.Subject, subjectPhrase, vbTextCompare) > 0 Then
                Debug.Print "FOUND:"
                Debug.Print "Received: " & mail.ReceivedTime
                Debug.Print "Subject:  " & mail.Subject

                SaveAttachments_Late mail, targetFolder
                Exit Sub
            End If
        End If
    Next i

    MsgBox "Не найдено письмо с фразой в теме: " & subjectPhrase, vbExclamation
End Sub

Private Sub SaveAttachments_Late(ByVal mail As Object, ByVal targetFolder As String)
    Dim att As Object
    For Each att In mail.Attachments
        att.SaveAsFile targetFolder & "\" & att.FileName
    Next att
End Sub
