–ú–æ–∂–Ω–æ ‚Äî –∏ —ç—Ç–æ –∫–∞–∫ —Ä–∞–∑ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–π –ø—É—Ç—å –≤ PQ. –ù–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É ‚Äú–¥–µ–ª–∞—Ç—å‚Äù –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ç–µ–±–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –Ω—É–∂–µ–Ω ‚Äú–∫–∞–Ω–æ–Ω‚Äù –¥–ª—è Prefix6/7, –∏–Ω–∞—á–µ —Ñ–∏–ª—å—Ç—Ä –Ω–µ –∑–Ω–∞–µ—Ç, –≤–æ —á—Ç–æ –∑–∞–º–µ–Ω—è—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–æ–∫–µ–Ω.

–¢–æ –µ—Å—Ç—å –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π ‚Äú–º–∞–ø—ã‚Äù –º–æ–∂–Ω–æ, –µ—Å–ª–∏ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å –≤—Å—ë –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
—Å–Ω–∞—á–∞–ª–∞ –ø–æ—Å—á–∏—Ç–∞–µ—à—å –∫–∞–Ω–æ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ Prefix6/7, –ø–æ—Ç–æ–º –¥–∂–æ–π–Ω–∏—à—å –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –∫ —Å—Ç—Ä–æ–∫–∞–º –∏ –ø—Ä–∏–º–µ–Ω—è–µ—à—å —Ñ–∏–ª—å—Ç—Ä.

–ù–∏–∂–µ ‚Äî –ø–æ–Ω—è—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ (–±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ TokenMap6).

‚∏ª

‚úÖ –û–¥–∏–Ω –∑–∞–ø—Ä–æ—Å: –¥–æ–±–∞–≤–∏—Ç—å Prefix6 + Canonical6 + TokenNorm

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —Ç—ã —Å–µ–π—á–∞—Å –≤ TokenStats_Families (Token, TF, Tokenlength, Prefix10‚Ä¶).

1) –î–æ–±–∞–≤—å Prefix6 (–∏–ª–∏ Prefix7)

Spalte hinzuf√ºgen ‚Üí Benutzerdefinierte Spalte

Text.Start([Token], 6)

–ù–∞–∑–æ–≤–∏ Prefix6.

‚∏ª

2) –°–¥–µ–ª–∞–π ‚Äú—Ç–∞–±–ª–∏—Ü—É –∫–∞–Ω–æ–Ω–æ–≤‚Äù –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ —ç—Ç–æ–≥–æ –∂–µ –∑–∞–ø—Ä–æ—Å–∞

–î–µ–ª–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–µ–∫—É—â—É—é —Ç–∞–±–ª–∏—Ü—É, –≥—Ä—É–ø–ø–∏—Ä—É–µ–º –∏ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω –ø–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.

–î–æ–º–∞—à–Ω—è—è –ª–æ–≥–∏–∫–∞:
	‚Ä¢	—Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—ë–º CanonByPrefix6 (Prefix6 ‚Üí Canonical6)
	‚Ä¢	–ø–æ—Ç–æ–º Merge –µ—ë –æ–±—Ä–∞—Ç–Ω–æ

–í UI —ç—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è —Ç–∞–∫:

A) –°–¥–µ–ª–∞–π –¥—É–±–ª–∏–∫–∞—Ç —à–∞–≥–∞ (–Ω–µ –∑–∞–ø—Ä–æ—Å–∞)

–í —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ —à–∞–≥–æ–≤:
	‚Ä¢	–Ω–∞ —à–∞–≥–µ, –≥–¥–µ —É–∂–µ –µ—Å—Ç—å Prefix6, –ü–ö–ú ‚Üí Duplizieren (–¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è —à–∞–≥ –≤–Ω—É—Ç—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞)
–∏–ª–∏ –ø—Ä–æ—â–µ: –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–¥–æ–ª–∂–∞–π –∏ –ø–æ—Ç–æ–º –≤–µ—Ä–Ω—ë—à—å—Å—è —á–µ—Ä–µ–∑ ‚Äú–ù–∞–∑–∞–¥‚Äù ‚Äî –Ω–æ –ª—É—á—à–µ –¥—É–±–ª–∏–∫–∞—Ç —á–µ—Ä–µ–∑ Advanced Editor.
–ï—Å–ª–∏ UI –Ω–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å —à–∞–≥, –¥–µ–ª–∞–µ–º B.

B) –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π UI-–≤–∞—Ä–∏–∞–Ω—Ç (–±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —à–∞–≥–æ–≤):
	1.	Reference –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–°–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É) ‚Äî —ç—Ç–æ –±—É–¥–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π ‚Äú–≤—Ä–µ–º–µ–Ω–Ω—ã–π‚Äù –∑–∞–ø—Ä–æ—Å, –Ω–æ –±–µ–∑ —Ä—É—á–Ω–æ–π —Å–±–æ—Ä–∫–∏.
–ï—Å–ª–∏ —Å–æ–≤—Å–µ–º –Ω–µ —Ö–æ—á–µ—à—å –≤—Ç–æ—Ä–æ–π –∑–∞–ø—Ä–æ—Å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π Advanced Editor (—Å–º. –Ω–∏–∂–µ).

–°–∫–∞–∂—É —á–µ—Å—Ç–Ω–æ: –±–µ–∑ –≤—Ç–æ—Ä–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (—Ö–æ—Ç—è –±—ã ‚ÄúReference‚Äù) –≤ UI —Å–¥–µ–ª–∞—Ç—å merge –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ù–æ —ç—Ç–æ –Ω–µ ‚Äú–Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä—É–∫–∞–º–∏‚Äù, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å—Å—ã–ª–∫–∞.

‚∏ª

‚úÖ –°–∞–º—ã–π —á–∏—Å—Ç—ã–π –≤–∞—Ä–∏–∞–Ω—Ç: 10 —Å—Ç—Ä–æ–∫ M-–∫–æ–¥–∞ (–≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞)

–ï—Å–ª–∏ –æ–∫ –≤—Å—Ç–∞–≤–∏—Ç—å –∫—É—Å–æ–∫ M –≤ Advanced Editor, —Ç–æ –≤–æ—Ç —Ä–µ—à–µ–Ω–∏–µ –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ —Ç–µ–∫—É—â–∏–π —à–∞–≥ —Å Prefix6 –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è #"Added Prefix6".

let
    Source = #"Added Prefix6",

    // 1) —Ç–∞–±–ª–∏—Ü–∞ –∫–∞–Ω–æ–Ω–æ–≤ –ø–æ Prefix6
    CanonByPrefix6 =
        Table.Group(
            Table.Sort(Source, {{"Prefix6", Order.Ascending}, {"Tokenlength", Order.Descending}, {"TF", Order.Descending}}),
            {"Prefix6"},
            {{"Canonical6", each _{0}[Token], type text}}
        ),

    // 2) –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º –∫–∞–Ω–æ–Ω –æ–±—Ä–∞—Ç–Ω–æ
    Merged = Table.NestedJoin(Source, {"Prefix6"}, CanonByPrefix6, {"Prefix6"}, "Canon", JoinKind.LeftOuter),
    Expanded = Table.ExpandTableColumn(Merged, "Canon", {"Canonical6"}, {"Canonical6"}),

    // 3) —Ñ–∏–ª—å—Ç—Ä/–∑–∞–º–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è ‚Äú–æ–±—Ä—É–±–∫–æ–≤‚Äù
    TokenNorm = Table.AddColumn(
        Expanded,
        "TokenNorm",
        each if [Tokenlength] <= 8 and [TF] <= 3 and [Canonical6] <> null and [Token] <> [Canonical6]
             then [Canonical6]
             else [Token],
        type text
    )
in
    TokenNorm

–ß—Ç–æ —ç—Ç–æ –¥–∞—ë—Ç:
	‚Ä¢	Prefix6 –¥–æ–±–∞–≤–ª–µ–Ω
	‚Ä¢	Canonical6 –≤—ã—á–∏—Å–ª–µ–Ω
	‚Ä¢	–æ–±—Ä–∞—Ç–Ω–æ —Å–º—ë—Ä–∂–µ–Ω
	‚Ä¢	TokenNorm —Å–æ–∑–¥–∞–Ω –ø–æ —Ç–≤–æ–µ–º—É ‚Äú—Å–ª–æ—é 2‚Äù

–ò –≤—Å—ë –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ.

‚∏ª

üí° –ö–∞–∫ –ø–æ–º–µ–Ω—è—Ç—å –ø–æ—Ä–æ–≥–∏

–í —Å—Ç—Ä–æ–∫–µ if [Tokenlength] <= 8 and [TF] <= 3 ...:
	‚Ä¢	<=8 –∏ <=3 –º–µ–Ω—è–µ—à—å –Ω–∞ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è.

‚∏ª

üü¶ –í–∞—Ä–∏–∞–Ω—Ç ‚Äú–±–µ–∑ –∑–∞–º–µ–Ω—ã‚Äù, —Ç–æ–ª—å–∫–æ —Ñ–∏–ª—å—Ç—Ä

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å—Ç–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é, –¥–æ–±–∞–≤—å –∫–æ–ª–æ–Ω–∫—É-—Ñ–ª–∞–≥:

each [Tokenlength] <= 8 and [TF] <= 3 and [Token] <> [Canonical6]


‚∏ª

–ï—Å–ª–∏ —Å–∫–∞–∂–µ—à—å, –∫–∞–∫ —É —Ç–µ–±—è —Ç–æ—á–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —à–∞–≥, –≥–¥–µ —É–∂–µ –µ—Å—Ç—å Prefix10/Tokenlength/TF (–∏–º—è —à–∞–≥–∞ —Å–ª–µ–≤–∞), —è –ø–æ–¥—Å—Ç–∞–≤–ª—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è –≤ M-–∫–æ–¥, —á—Ç–æ–±—ã —Ç—ã –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏–ª –∏ –æ–Ω–æ —Å—Ä–∞–∑—É –∑–∞—Ä–∞–±–æ—Ç–∞–ª–æ.
