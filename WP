–ü–æ–Ω—è–ª, —Ç—ã —É–ø—ë—Ä—Å—è –≤ —Ç–∏–ø–∏—á–Ω—ã–π ‚Äú–∑–∞—Ç—ã–∫‚Äù Power Query: –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–¥–µ–ª–∞—Ç—å Group By ‚Üí All Rows –∏ –ø–æ—Ç–æ–º –≤—ã—Ç–∞—â–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ç–æ–∫–µ–Ω –∫–∞–∫ Canonical.

–°—Ä–∞–∑—É: –¥–∞, –ø–æ—Å–ª–µ Group By —É —Ç–µ–±—è –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤—Å–µ–≥–æ 2 –∫–æ–ª–æ–Ω–∫–∏ (Prefix4 –∏ AllRows), –∏ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ü–æ—Ç–æ–º —Ç—ã –¥–æ–±–∞–≤–ª—è–µ—à—å CanonicalToken, –∞ —É–∂–µ –ø–æ—Ç–æ–º —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—à—å –æ–±—Ä–∞—Ç–Ω–æ.

–ù–∏–∂–µ ‚Äî —Ç–æ—á–Ω–∞—è –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è.

‚∏ª

‚úÖ –®–∞–≥ C ‚Äî –≤—ã–±—Ä–∞—Ç—å CanonicalToken –≤ –∫–∞–∂–¥–æ–º Prefix4

0) –£–±–µ–¥–∏—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞

–î–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å–¥–µ–ª–∞–π Sort:
	‚Ä¢	Prefix4 ‚Üë
	‚Ä¢	Tokenlength ‚Üì
	‚Ä¢	TF ‚Üì

–≠—Ç–æ —É —Ç–µ–±—è –Ω–∞ —Å–∫—Ä–∏–Ω–µ —É–∂–µ –µ—Å—Ç—å (Table.Sort(...Tokenlength desc..., TF desc...)) ‚Äî –æ—Ç–ª–∏—á–Ω–æ.

‚∏ª

1) –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ ‚ÄúAll Rows‚Äù (Alle Zeilen)

–í Power Query:

Start ‚Üí Gruppieren nach

–í –æ–∫–Ω–µ:

Gruppieren nach:
	‚Ä¢	Prefix4

Neue Spalte:
	‚Ä¢	–Ω–∞–∑–æ–≤–∏ AllRows (–∏–ª–∏ –∫–∞–∫ —Ö–æ—á–µ—à—å)

Vorgang (Operation):
	‚Ä¢	Alle Zeilen (All Rows)

‚ö†Ô∏è –í–∞–∂–Ω–æ: –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äú–ø—Ä–æ—Å–∏—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å‚Äù ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç—ã –≤—ã–±—Ä–∞–ª –Ω–µ ‚ÄúAlle Zeilen‚Äù, –∞ ‚ÄúAnzahl Zeilen‚Äù, ‚ÄúSumme‚Äù –∏ —Ç.–ø.
–¢–µ–±–µ –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ –ø—É–Ω–∫—Ç Alle Zeilen. –¢–æ–≥–¥–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –Ω–µ –Ω—É–∂–µ–Ω.

–ü–æ—Å–ª–µ OK –ø–æ–ª—É—á–∏—Ç—Å—è —Ç–∞–±–ª–∏—Ü–∞:

Prefix4	AllRows
acti	Table
adve	Table
apfe	Table

–ò –≤—Å—ë. –¢–∞–∫ –∏ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å.

‚∏ª

2) –î–æ–±–∞–≤—å CanonicalToken

–¢–µ–ø–µ—Ä—å –î–æ–±–∞–≤–∏—Ç—å —Å—Ç–æ–ª–±–µ—Ü ‚Üí Benutzerdefinierte Spalte (Custom Column)

–ò–º—è: CanonicalToken

–§–æ—Ä–º—É–ª–∞:

[AllRows]{0}[Token]

–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
	‚Ä¢	AllRows ‚Äî —ç—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö —Ç–æ–∫–µ–Ω–æ–≤ –¥–∞–Ω–Ω–æ–≥–æ Prefix4
	‚Ä¢	{0} ‚Äî –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ (–∞ –æ–Ω–∞ ‚Äú–ª—É—á—à–∞—è‚Äù, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ –î–û –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏)
	‚Ä¢	[Token] ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–ª–æ–Ω–∫–∏ Token

‚∏ª

3) –†–∞–∑–≤–µ—Ä–Ω–∏ AllRows –æ–±—Ä–∞—Ç–Ω–æ (Expand)

–ù–∞–∂–º–∏ –Ω–∞ –∑–Ω–∞—á–æ–∫ –¥–≤—É—Ö —Å—Ç—Ä–µ–ª–æ–∫ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ AllRows.

–í—ã–±–µ—Ä–∏ –∫–æ–ª–æ–Ω–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—á–µ—à—å –≤–µ—Ä–Ω—É—Ç—å:
	‚Ä¢	Token (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
	‚Ä¢	–º–æ–∂–Ω–æ –µ—â—ë TF, Tokenlength (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏), –Ω–æ –ø–æ—Ç–æ–º —É–¥–∞–ª–∏—Ç—å

–í–ê–ñ–ù–û: —É–±–µ—Ä–∏ –≥–∞–ª–æ—á–∫—É ‚ÄúUse original column name as prefix‚Äù (–µ—Å–ª–∏ –º–µ—à–∞–µ—Ç).

–ü–æ—Å–ª–µ Expand —É —Ç–µ–±—è –±—É–¥–µ—Ç:

Prefix4	CanonicalToken	Token	TF	Tokenlength



‚∏ª

4) –û—Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ map

–û—Å—Ç–∞–≤—å –∫–æ–ª–æ–Ω–∫–∏:
	‚Ä¢	Token
	‚Ä¢	CanonicalToken

–£–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω–æ–µ.

–ü–æ–ª—É—á–∏—Ç—Å—è TokenMap:

Token -> CanonicalToken


‚∏ª

‚úÖ –û—Ç–≤–µ—Ç –Ω–∞ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä—è–º–æ

1) ‚Äú–ö–æ–≥–¥–∞ –≥—Ä—É–ø–ø–∏—Ä—É—é Alle Zeilen –º–Ω–µ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø—Ä–µ–¥–ª–∞–≥–∞—é—Ç –≤—ã–±—Ä–∞—Ç—å –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å‚Äù

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —Ç—ã –Ω–µ –≤—ã–±—Ä–∞–ª Alle Zeilen, –∞ –≤—ã–±—Ä–∞–ª –¥—Ä—É–≥–æ–π —Ç–∏–ø –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.
–í PQ ‚ÄúAlle Zeilen‚Äù –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è –≤–æ–æ–±—â–µ.

2) ‚Äú–Ø –º–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —è –≤—ã–±—Ä–∞–ª –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏‚Äù

–ü–æ—Å–ª–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Ç—ã —É–∂–µ –º–æ–∂–µ—à—å –¥–æ–±–∞–≤–ª—è—Ç—å –∫–æ–ª–æ–Ω–∫—É, –ø–æ—Ç–æ–º—É —á—Ç–æ AllRows ‚Äî —ç—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏. –ù–∏–∫–∞–∫–∏—Ö –∫–æ–ª–æ–Ω–æ–∫ ‚Äú–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å‚Äù –¥–æ —ç—Ç–æ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ.
–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫:
	‚Ä¢	Group By ‚Üí –ø–æ–ª—É—á–∞–µ—à—å Prefix4 + AllRows
	‚Ä¢	Add Column ‚Üí CanonicalToken = [AllRows]{0}[Token]
	‚Ä¢	Expand ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å Token
	‚Ä¢	–û—Å—Ç–∞–≤–ª—è–µ—à—å Token –∏ CanonicalToken

3) ‚Äú–ù—É–∂–Ω–æ Token —Å—Ä–∞–∑—É –ø–æ Allrows –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å?‚Äù

–ù–µ—Ç. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –Ω—É–∂–Ω–æ –ø–æ Prefix4, –∞ AllRows ‚Äî —ç—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞–≥—Ä–µ–≥–∞—Ü–∏–∏.

‚∏ª

üß™ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–≤–æ—ë–º –ø—Ä–∏–º–µ—Ä–µ

–î–ª—è adve —É —Ç–µ–±—è —Å–≤–µ—Ä—Ö—É:
	‚Ä¢	adventskalender
	‚Ä¢	adventsgesteck
	‚Ä¢	adventskerzen
	‚Ä¢	adventskranz
	‚Ä¢	adventskal
	‚Ä¢	adventsk
‚Ä¶

–ü–æ—Å–ª–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–ª–∏–Ω–µ‚Üì TF‚Üì –∫–∞–Ω–æ–Ω–æ–º —Å—Ç–∞–Ω–µ—Ç adventskalender (–∏–ª–∏ —Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π/—á–∞—Å—Ç–æ—Ç–Ω—ã–π –∏–∑ —Å–ø–∏—Å–∫–∞) ‚Äî –∏ –≤—Å–µ adventsk, adventskal –±—É–¥—É—Ç –º–∞–ø–ø–∏—Ç—å—Å—è —Ç—É–¥–∞.

‚∏ª

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —Å–∫–∏–Ω—å 2 —Å—Ç—Ä–æ–∫–∏ M-–∫–æ–¥–∞ –∏–∑ —à–∞–≥–∞ Group By (–∏–∑ Advanced Editor) ‚Äî —è —Å–∫–∞–∂—É, –ø–æ—á–µ–º—É —É —Ç–µ–±—è –Ω–µ –≤–∏–¥–µ–Ω –ø—É–Ω–∫—Ç ‚ÄúAlle Zeilen‚Äù (–∏–Ω–æ–≥–¥–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —è–∑—ã–∫–∞/–≤–µ—Ä—Å–∏–∏ –ø—Ä—è—á–µ—Ç –µ–≥–æ –≤ ‚ÄúErweitert‚Äù).

–ü–æ–Ω—è–ª —Ç–µ–±—è. –î–∞–≤–∞–π —Ä–µ–∑–∫–æ —É–ø—Ä–æ—Å—Ç–∏–º –∏ —Å–¥–µ–ª–∞–µ–º –ø–æ–Ω—è—Ç–Ω—ã–π, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π ‚Äú–∞–≤—Ç–æ–º–∞—Ç‚Äù –≤ 2 —à–∞–≥–∞, –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –±–µ–∑ co-occurrence. –≠—Ç–æ –¥–∞—Å—Ç –∑–∞–º–µ—Ç–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç —É–∂–µ —Å–µ–π—á–∞—Å –∏ –Ω–µ —Å–ª–æ–º–∞–µ—Ç –º–æ–∑–≥.

–ß—Ç–æ –º—ã –¥–µ–ª–∞–µ–º —Å–µ–π—á–∞—Å
	1.	–°—Ç—Ä–æ–∏–º —Å–µ–º–µ–π—Å—Ç–≤–∞ –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É (—Ç—ã —É–∂–µ –Ω–∞—á–∞–ª).
	2.	–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–∫–µ–Ω–∞ –≤—ã–±–∏—Ä–∞–µ–º ‚Äú–∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–π‚Äù —Ç–æ–∫–µ–Ω —Å–µ–º–µ–π—Å—Ç–≤–∞ (–æ–±—ã—á–Ω–æ —Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π –∏/–∏–ª–∏ —Å–∞–º—ã–π —á–∞—Å—Ç–æ—Ç–Ω—ã–π).
	3.	–ó–∞–º–µ–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã –Ω–∞ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ.

‚ö†Ô∏è –î–∞, –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç—å —Ç–∏–ø–∞ adventsk (kalender vs kerzen) —ç—Ç–∏–º –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è –∏–¥–µ–∞–ª—å–Ω–æ ‚Äî –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ 1. –°–Ω–∞—á–∞–ª–∞ –≤—ã—á–∏—â–∞–µ–º 80% ‚Äú–æ–±—Ä—É–±–∫–æ–≤‚Äù, –ø–æ—Ç–æ–º –¥–æ–±–∞–≤–∏–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤.

‚∏ª

1) Families ‚Äî –∫–∞–∫ —Å—á–∏—Ç–∞—Ç—å (—Ç–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–∫)

–¢—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—à—å:
	‚Ä¢	MaxLen >= 4
	‚Ä¢	DistinctTokens > 3

–û–∫. –¢–æ–ª—å–∫–æ —è –±—ã –¥–µ–ª–∞–ª Prefix4 –∏–ª–∏ Prefix5, –∏–Ω–∞—á–µ Prefix3 —Å–ª–∏—à–∫–æ–º —à—É–º–Ω—ã–π.

–í TokenStats (Token, TF):
	‚Ä¢	–î–æ–±–∞–≤—å Len = Text.Length([Token])
	‚Ä¢	–î–æ–±–∞–≤—å Prefix4 = Text.Start([Token], 4)  (–∏–ª–∏ 5)

Group by Prefix4:
	‚Ä¢	DistinctTokens = Anzahl unterschiedlicher Token
	‚Ä¢	MaxLen = Maximum Len
	‚Ä¢	SumTF = Sum TF (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ –ø–æ–ª–µ–∑–Ω–æ)

–§–∏–ª—å—Ç—Ä:
	‚Ä¢	DistinctTokens > 3
	‚Ä¢	MaxLen >= 4

–°–æ—Ö—Ä–∞–Ω–∏ –∫–∞–∫ Families.

‚∏ª

2) –ü–æ–Ω—è—Ç—å ‚ÄúShort‚Äù –∏ ‚ÄúLong‚Äù –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ

–¢–µ–±–µ –Ω–µ –Ω—É–∂–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã short/long –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚Äî —ç—Ç–æ –∏ —Å–±–∏–≤–∞–µ—Ç —Å —Ç–æ–ª–∫—É.

–°–¥–µ–ª–∞–µ–º –æ–¥–Ω—É —Ç–∞–±–ª–∏—Ü—É Map (Token ‚Üí CanonicalToken).

‚∏ª

3) –°–¥–µ–ª–∞—Ç—å CanonicalToken –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–º–µ–π—Å—Ç–≤–∞

–ò–¥–µ—è: –≤ –∫–∞–∂–¥–æ–º Prefix-—Å–µ–º–µ–π—Å—Ç–≤–µ –≤—ã–±–∏—Ä–∞–µ–º 1 ‚Äú–≥–ª–∞–≤–Ω—ã–π‚Äù —Ç–æ–∫–µ–Ω.

–°–∞–º—ã–π –ø–æ–Ω—è—Ç–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏ 1:
	‚Ä¢	—Å–Ω–∞—á–∞–ª–∞ –ø–æ –¥–ª–∏–Ω–µ ‚Üì
	‚Ä¢	–µ—Å–ª–∏ –¥–ª–∏–Ω–∞ —Ä–∞–≤–Ω–∞ ‚Äî –ø–æ TF ‚Üì
	‚Ä¢	–±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–π

–¢–æ –µ—Å—Ç—å ‚Äú—Å–∞–º—ã–π –¥–ª–∏–Ω–Ω—ã–π –∏ —Å–∞–º—ã–π —á–∞—Å—Ç–æ—Ç–Ω—ã–π‚Äù.

–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –≤ Power Query (–ø—Ä—è–º —à–∞–≥–∞–º–∏)

–®–∞–≥ A ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤—å TokenStats —Å Prefix4

–í TokenStats –¥–æ–±–∞–≤—å Prefix4 –∏ Len (–∫–∞–∫ –≤—ã—à–µ).

–®–∞–≥ B ‚Äî –æ—Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ —Ç–æ–∫–µ–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—Ö–æ–¥—è—Ç –≤ Families

–°–¥–µ–ª–∞–π Merge:
	‚Ä¢	TokenStats JOIN Families –ø–æ Prefix4
	‚Ä¢	Join type: Inner
–ü–æ–ª—É—á–∏—à—å TokenStats_Families.

–®–∞–≥ C ‚Äî –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ Prefix4 –≤—ã–±—Ä–∞—Ç—å –∫–∞–Ω–æ–Ω
	1.	–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π TokenStats_Families:

	‚Ä¢	–ø–æ Prefix4 (–≤–≤–µ—Ä—Ö)
	‚Ä¢	–ø–æ—Ç–æ–º –ø–æ Len (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
	‚Ä¢	–ø–æ—Ç–æ–º –ø–æ TF (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)

	2.	Group by Prefix4

	‚Ä¢	Operation: Alle Zeilen (All rows)

	3.	–î–æ–±–∞–≤—å Custom Column CanonicalToken:

[AllRows]{0}[Token]

–ü–æ—Ç–æ–º—É —á—Ç–æ –º—ã —É–∂–µ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª–∏ —Ç–∞–∫, —á—Ç–æ ‚Äú–ª—É—á—à–∏–π‚Äù —Ç–æ–∫–µ–Ω –ø–µ—Ä–≤—ã–π.
	4.	–†–∞–∑–≤–µ—Ä–Ω–∏ —Ç–∞–±–ª–∏—Ü—É –æ–±—Ä–∞—Ç–Ω–æ:

	‚Ä¢	Expand AllRows –∏ –æ—Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ:
	‚Ä¢	Token
	‚Ä¢	CanonicalToken

–ü–æ–ª—É—á–∏—à—å –∫–∞—Ä—Ç—É:

Token | CanonicalToken

–ù–∞–∑–æ–≤–∏ –∑–∞–ø—Ä–æ—Å: TokenMap

‚∏ª

4) –ü—Ä–∏–º–µ–Ω–∏—Ç—å TokenMap –∫ —Ç–≤–æ–µ–π TokenTable

–¢–µ–ø–µ—Ä—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∞.
	1.	–û—Ç–∫—Ä–æ–π TokenTable (Artikelnummer, Token)
	2.	Merge —Å TokenMap –ø–æ Token (Left join)
	3.	Expand CanonicalToken
	4.	–°–æ–∑–¥–∞–π –∫–æ–ª–æ–Ω–∫—É TokenNorm:

if [CanonicalToken] <> null then [CanonicalToken] else [Token]

	5.	–£–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –∫–æ–ª–æ–Ω–∫–∏ CanonicalToken/Token (–∏–ª–∏ –æ—Å—Ç–∞–≤—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)

–¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è:

Artikelnummer | TokenNorm


‚∏ª

5) –°–æ–±—Ä–∞—Ç—å ClusterKey —É–∂–µ –ø–æ TokenNorm

–ö–∞–∫ –º—ã –¥–µ–ª–∞–ª–∏ —Ä–∞–Ω—å—à–µ:
	‚Ä¢	Group by Artikelnummer ‚Üí AllRows
	‚Ä¢	ClusterKey = Text.Combine(List.Sort([AllRows][TokenNorm]), ‚Äú|‚Äù)

‚∏ª

–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–µ—à–µ–Ω–∏–µ ‚Äú–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ‚Äù
	‚Ä¢	—Ç—ã –Ω–µ –≤—ã–ø–∏—Å—ã–≤–∞–µ—à—å –≤—Ä—É—á–Ω—É—é adventsk ‚Üí adventskalender
	‚Ä¢	–∫–∞–Ω–æ–Ω –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –¥–ª–∏–Ω–µ/—á–∞—Å—Ç–æ—Ç–µ
	‚Ä¢	–≤—Å–µ —É—Å–µ—á–µ–Ω–∏—è ‚Äú–ø—Ä–∏—Ç—è–≥–∏–≤–∞—é—Ç—Å—è‚Äù –∫ –æ–¥–Ω–æ–º—É –∫–∞–Ω–æ–Ω—É

‚∏ª

–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –¥–≤—É—Å–º—ã—Å–ª–µ–Ω–Ω–æ—Å—Ç—å—é (kalender vs kerzen)

–≠—Ç–æ –±—É–¥–µ—Ç ‚Äú–ø—Ä–æ–±–ª–µ–º–∞ –∏—Ç–µ—Ä–∞—Ü–∏–∏ 2‚Äù.

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:
	1.	–ù–∞ –∏—Ç–µ—Ä–∞—Ü–∏–∏ 1 —Å–¥–µ–ª–∞—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é ‚Äú–ø–æ —Å–µ–º–µ–π—Å—Ç–≤—É‚Äù.
	2.	–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–æ–ø 20 —Å–µ–º–µ–π—Å—Ç–≤, –≥–¥–µ –∫–∞–Ω–æ–Ω —è–≤–Ω–æ –Ω–µ–≤–µ—Ä–Ω—ã–π (—Ç–∏–ø–∞ advents‚Ä¶).
	3.	–¢–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö 20 —Å–µ–º–µ–π—Å—Ç–≤ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞.

–¢–∞–∫ —Ç—ã –Ω–µ —Å—Ç—Ä–æ–∏—à—å –º–æ–Ω—Å—Ç—Ä–∞, –∞ –¥–µ–ª–∞–µ—à—å —Ç–æ—á–µ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è.

‚∏ª

–ú–∏–Ω–∏-—á–µ–∫

–ï—Å–ª–∏ —Ç—ã —Å–¥–µ–ª–∞–µ—à—å TokenMap, —Ç–æ –≤ —Ç–≤–æ—ë–º –ø—Ä–∏–º–µ—Ä–µ —Å–µ–º–µ–π—Å—Ç–≤–æ adve (advents‚Ä¶) —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø—Ä–∏—Ç—è–Ω–µ—Ç—Å—è –∫ —Å–∞–º–æ–º—É –¥–ª–∏–Ω–Ω–æ–º—É: adventskalender –∏–ª–∏ adventskerzen ‚Äî –¥–∞, –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å ‚Äú–Ω–µ —Ç–æ—Ç‚Äù, –Ω–æ –≤—Å–µ –æ–±—Ä—É–±–∫–∏ —Å—Ç–∞–Ω—É—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–º–∏, –∏ —ç—Ç–æ —É–∂–µ –æ–≥—Ä–æ–º–Ω—ã–π —à–∞–≥.

‚∏ª

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, —è –º–æ–≥—É –ø—Ä—è–º–æ –¥–∞—Ç—å M-—Ñ–æ—Ä–º—É–ª—ã –¥–ª—è —Ç—Ä—ë—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Families, TokenMap, TokenTable_Norm) –≤ –≤–∏–¥–µ –≥–æ—Ç–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ ‚Äî —Ç—ã –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏—à—å –≤ Advanced Editor. –ù–æ —Å–∫–∞–∂–∏: —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Prefix4 –∏–ª–∏ Prefix5? (—è –±—ã –Ω–∞—á–∞–ª —Å Prefix5, –º–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤).
