let
    // 0) Quelle: Tabelle Werbung_raw aus Excel
    Quelle = Excel.CurrentWorkbook(){[Name="Werbung_raw"]}[Content],

    // 1) Typen (по необходимости можешь расширить список колонок)
    #"Geänderter Typ" =
        Table.TransformColumnTypes(
            Quelle,
            {
                {"Thema", type text},
                {"Produktname", type text},
                {"Region", type text},
                {"Preis", type any}
            }
        ),

    // 2) Produktname säubern (Trim + Clean)
    #"Produktname getrimmt" =
        Table.TransformColumns(
            #"Geänderter Typ",
            {{"Produktname", each Text.Trim(_), type text}}
        ),

    #"Produktname bereinigt" =
        Table.TransformColumns(
            #"Produktname getrimmt",
            {{"Produktname", each Text.Clean(_), type text}}
        ),

    // 3) q_Match_light einmal puffern (damit PQ nicht dauernd neu durchrechnet)
    MatchBuf = Table.Buffer(q_Match_light),

    // 4) Merge: Werbung_raw[Produktname] -> q_Match_light[Name]
    #"Zusammengeführte Abfragen" =
        Table.NestedJoin(
            #"Produktname bereinigt",
            {"Produktname"},
            MatchBuf,
            {"Name"},
            "Match",
            JoinKind.LeftOuter
        ),

    // 5) Match expandieren: нужные поля из q_Match_light
    #"Erweiterte Match" =
        Table.ExpandTableColumn(
            #"Zusammengeführte Abfragen",
            "Match",
            {"Aktionspreis min", "Anbieter", "Kalenderwoche", "% Märkte"},
            {"Aktionspreis min", "Anbieter", "Kalenderwoche", "% Märkte"}
        ),

    // 6) Финальный набор колонок (ровно как ты описал)
    #"Spalten ausgewählt" =
        Table.SelectColumns(
            #"Erweiterte Match",
            {"Thema", "Produktname", "Aktionspreis min", "Anbieter", "Kalenderwoche", "% Märkte", "Region", "Preis"}
        )
in
    #"Spalten ausgewählt"
