Option Explicit

' Show the floating form
Sub OpenGetraenkeSearchForm()
    frmGetraenkeSearch.Show
End Sub

' Apply filter on sheet "Getränke" by column B
Sub ApplyGetraenkeFilter(ByVal searchText As String)
    Dim ws As Worksheet
    Dim rng As Range
    Dim crit As String
    
    Set ws = ThisWorkbook.Worksheets("Getränke")
    Set rng = ws.Range("A1").CurrentRegion   ' table with headers in row 1
    
    ' Turn on AutoFilter if needed
    If Not rng.AutoFilterMode Then
        rng.AutoFilter
    End If
    
    If Len(searchText) = 0 Then
        ' Clear filter
        On Error Resume Next
        ws.ShowAllData
        On Error GoTo 0
    Else
        ' Convert "Radeberger Pils 20x500"
        ' to "*Radeberger*Pils*20x500*"
        crit = "*" & Replace(searchText, " ", "*") & "*"
        
        ' Column B is field 2
        rng.AutoFilter Field:=2, Criteria1:=crit
    End If
End Sub
