–†–∞–¥–∞, —á—Ç–æ —Ç—ã —ç—Ç–æ –∑–∞—Ç–µ—è–ª ‚Äì —à—Ç—É–∫–∞ –±—É–¥–µ—Ç –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–Ω–∞—è üòâ
–í–æ—Ç –ø–æ–ª–Ω—ã–π –º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Ü–µ–ª–∏–∫–æ–º –≤—Å—Ç–∞–≤–∏—Ç—å –≤ VBA.

‚∏ª

1Ô∏è‚É£ –ì–æ—Ç–æ–≤—ã–π –∫–æ–¥ –º–æ–¥—É–ª—è

–û—Ç–∫—Ä–æ–π Alt + F11 ‚Üí Insert ‚Üí Module –∏ –≤—Å—Ç–∞–≤—å —Ç—É–¥–∞ –í–°–Å –Ω–∏–∂–µ—Å–ª–µ–¥—É—é—â–µ–µ:

Option Explicit

' –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ä–∞–∑–±–æ—Ä–∞ —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–¥—É–∫—Ç–∞
' part:
'   "BRAND"        ‚Äì –±—Ä–µ–Ω–¥ (–≤—Å—ë –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ–≤–∞ –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–∞—Ç–æ–º)
'   "TYPE"         ‚Äì —Ç–∏–ø (Pils, Medium, Classic, Sprudel –∏ —Ç.–ø., –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ)
'   "PACK"         ‚Äì —Ñ–æ—Ä–º–∞—Ç —É–ø–∞–∫–æ–≤–∫–∏ (20x0,5L / 4x6x0,33L / 12x0,7/0,75L)
'   "UNITS"        ‚Äì –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü (–±—É—Ç—ã–ª–æ–∫/–±–∞–Ω–æ–∫) –≤ —É–ø–∞–∫–æ–≤–∫–µ
'   "VOLUME"       ‚Äì –æ–±—ä—ë–º –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã (–∫–∞–∫ —Ç–µ–∫—Å—Ç, –Ω–∞–ø—Ä. "0,5" –∏–ª–∏ "0,7/0,75")
'   "VOLUMECLEAN"  ‚Äì –æ–±—ä—ë–º –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã, –æ—á–∏—â–µ–Ω–Ω—ã–π: –µ—Å–ª–∏ "0,7/0,75" ‚Üí –≤–µ—Ä–Ω—ë—Ç "0,75"
Public Function ParseProduct(ByVal txt As String, ByVal part As String) As String
    Dim re As Object, m As Object
    Dim pack As String, leftPart As String
    Dim brand As String, pType As String
    Dim units As Long
    Dim volume As String
    Dim arr() As String
    Dim cleaned As String
    
    ' --- 1. –ù–∞—Ö–æ–¥–∏–º —É–ø–∞–∫–æ–≤–∫—É: 20x0,5L / 4x6x0,33L / 12x0,7/0,75L / 6x1L ---
    Set re = CreateObject("VBScript.RegExp")
    re.Pattern = "(\d+x(?:\d+x)?[0-9,\/\.]+L)"
    re.Global = False
    re.IgnoreCase = True
    
    If re.Test(txt) Then
        Set m = re.Execute(txt)(0)
        pack = m.Value
        leftPart = Trim(Left$(txt, m.FirstIndex))
    Else
        pack = ""
        leftPart = Trim(txt)
    End If
    
    ' --- 2. –î–µ–ª–∏–º leftPart –Ω–∞ Brand –∏ Type (–ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ = —Ç–∏–ø) ---
    If Len(leftPart) > 0 Then
        Set re = CreateObject("VBScript.RegExp")
        re.Pattern = "([A-Za-z√Ñ√ñ√ú√§√∂√º√ü]+)$"
        re.Global = False
        re.IgnoreCase = True
        
        If re.Test(leftPart) Then
            Set m = re.Execute(leftPart)(0)
            pType = m.Value
            brand = Trim(Left$(leftPart, m.FirstIndex))
        Else
            brand = leftPart
            pType = ""
        End If
    End If
    
    ' --- 3. –ò–∑ pack –≤—ã—Ç–∞—Å–∫–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –æ–±—ä—ë–º ---
    If pack <> "" Then
        cleaned = Replace(pack, "L", "")
        arr = Split(cleaned, "x")
        
        If UBound(arr) = 1 Then
            ' –ü—Ä–∏–º–µ—Ä: 20x0,5
            If IsNumeric(arr(0)) Then units = CLng(arr(0))
            volume = arr(1)
        ElseIf UBound(arr) = 2 Then
            ' –ü—Ä–∏–º–µ—Ä: 4x6x0,33
            If IsNumeric(arr(0)) And IsNumeric(arr(1)) Then
                units = CLng(arr(0)) * CLng(arr(1))
            End If
            volume = arr(2)
        End If
    End If
    
    ' --- 4. –í–æ–∑–≤—Ä–∞—â–∞–µ–º –Ω—É–∂–Ω—É—é —á–∞—Å—Ç—å ---
    Select Case UCase$(part)
        Case "BRAND"
            ParseProduct = brand
        Case "TYPE"
            ParseProduct = pType
        Case "PACK"
            ParseProduct = pack
        Case "UNITS"
            If units > 0 Then ParseProduct = CStr(units)
        Case "VOLUME"
            ParseProduct = volume
        Case "VOLUMECLEAN"
            If InStr(volume, "/") > 0 Then
                Dim pieces() As String
                pieces = Split(volume, "/")
                ParseProduct = pieces(UBound(pieces)) ' –±–µ—Ä—ë–º –ø–æ—Å–ª–µ–¥–Ω—é—é —á–∞—Å—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä 0,75
            Else
                ParseProduct = volume
            End If
        Case Else
            ParseProduct = ""
    End Select
End Function

' --- –£–¥–æ–±–Ω—ã–µ –æ–±—ë—Ä—Ç–∫–∏, —á—Ç–æ–±—ã –Ω–µ –ø–∏—Å–∞—Ç—å –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç –≤ —è—á–µ–π–∫–µ ---

Public Function ProductBrand(ByVal txt As String) As String
    ProductBrand = ParseProduct(txt, "BRAND")
End Function

Public Function ProductType(ByVal txt As String) As String
    ProductType = ParseProduct(txt, "TYPE")
End Function

Public Function ProductPack(ByVal txt As String) As String
    ProductPack = ParseProduct(txt, "PACK")
End Function

Public Function ProductUnits(ByVal txt As String) As String
    ProductUnits = ParseProduct(txt, "UNITS")
End Function

Public Function ProductVolume(ByVal txt As String) As String
    ProductVolume = ParseProduct(txt, "VOLUME")
End Function

Public Function ProductVolumeClean(ByVal txt As String) As String
    ProductVolumeClean = ParseProduct(txt, "VOLUMECLEAN")
End Function

–°–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª –∫–∞–∫ .xlsm (–∫–Ω–∏–≥–∞ —Å –º–∞–∫—Ä–æ—Å–∞–º–∏).

‚∏ª

2Ô∏è‚É£ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ Excel

–ü—É—Å—Ç—å —Å—Ç—Ä–æ–∫–∞ —Å –ø—Ä–æ–¥—É–∫—Ç–æ–º –ª–µ–∂–∏—Ç –≤ B2, –Ω–∞–ø—Ä–∏–º–µ—Ä:

Gerolsteiner Sprudel/Medium/Naturell 12x0,75L Glas

–∏–ª–∏

Krombacher Pils 4x6x0,33L

–∏–ª–∏

Emsland Quelle Classic/Medium 12x0,7/0,75L Glas

–¢–µ–ø–µ—Ä—å –≤ —Å–æ—Å–µ–¥–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å:

üîπ –ë—Ä–µ–Ω–¥

=ProductBrand(B2)

–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
	‚Ä¢	Gerolsteiner Sprudel/Medium/Naturell
	‚Ä¢	Krombacher
	‚Ä¢	Emsland Quelle Classic/Medium

(–µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—à—å –ø–æ-–¥—Ä—É–≥–æ–º—É —Ä–µ–∑–∞—Ç—å –±—Ä–µ–Ω–¥/—Ç–∏–ø ‚Äî –ø–æ–¥—Å—Ç—Ä–æ–∏–º –ø—Ä–∞–≤–∏–ª–æ)

üîπ –¢–∏–ø (–ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–ª–æ–≤–æ –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–∞—Ç–æ–º)

=ProductType(B2)

–ü—Ä–∏–º–µ—Ä—ã:
	‚Ä¢	Naturell
	‚Ä¢	Pils
	‚Ä¢	Medium

üîπ –§–æ—Ä–º–∞—Ç —É–ø–∞–∫–æ–≤–∫–∏ (–∫–∞–∫ –≤ —Ç–µ–∫—Å—Ç–µ)

=ProductPack(B2)

–ü—Ä–∏–º–µ—Ä—ã:
	‚Ä¢	12x0,75L
	‚Ä¢	4x6x0,33L
	‚Ä¢	12x0,7/0,75L

üîπ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü (–±—É—Ç—ã–ª–æ–∫/–±–∞–Ω–æ–∫)

=ProductUnits(B2)

–ü—Ä–∏–º–µ—Ä—ã:
	‚Ä¢	12
	‚Ä¢	24 (–¥–ª—è 4x6x0,33L)
	‚Ä¢	12 (–¥–ª—è 12x0,7/0,75L)

üîπ –û–±—ä—ë–º –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã (–∫–∞–∫ –µ—Å—Ç—å)

=ProductVolume(B2)

–ü—Ä–∏–º–µ—Ä—ã:
	‚Ä¢	0,75
	‚Ä¢	0,33
	‚Ä¢	0,7/0,75

üîπ –û–±—ä—ë–º –æ–¥–Ω–æ–π –µ–¥–∏–Ω–∏—Ü—ã, ¬´–æ—á–∏—â–µ–Ω–Ω—ã–π¬ª

=ProductVolumeClean(B2)

–ü—Ä–∏–º–µ—Ä—ã:
	‚Ä¢	0,75
	‚Ä¢	0,33
	‚Ä¢	–∏–∑ 0,7/0,75 –≤–µ—Ä–Ω—ë—Ç 0,75

‚∏ª

3Ô∏è‚É£ –ß—Ç–æ –µ—â—ë –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

–ö–æ–≥–¥–∞ —ç—Ç–æ –≤—Å—ë –∑–∞—Ä–∞–±–æ—Ç–∞–µ—Ç, –º–æ–∂–Ω–æ –¥–∞–ª—å—à–µ –Ω–∞—Ä–∞—â–∏–≤–∞—Ç—å:
	‚Ä¢	–æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è IsAlkoholfrei(txt) ‚Üí 1/0 –∏–ª–∏ –î–∞/–ù–µ—Ç –ø–æ –Ω–∞–ª–∏—á–∏—é Alkoholfrei, 0,0%, AF, AF/ –∏ —Ç.–¥.;
	‚Ä¢	–æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä Glas / PET / PET-Cycle –≤ —Å—Ç–æ–ª–±–µ—Ü PackagingType;
	‚Ä¢	—Ä–∞–∑–±–æ—Ä –º–∏–≥—Ä–∞—Ü–∏–π (Migration 864175) –∏ GTIN.

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å, –≤ —Å–ª–µ–¥—É—é—â–µ–º —à–∞–≥–µ –º–æ–∂–µ–º –¥–æ–±–∞–≤–∏—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–ª–∞–≥ Alkoholfrei –∏ —Ç–∏–ø —É–ø–∞–∫–æ–≤–∫–∏.
