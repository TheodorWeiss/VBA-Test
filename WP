let
    t0 = #"Предыдущий шаг",

    // 1) Тип для ID (чтобы сортировка была числовая)
    t1 = Table.TransformColumnTypes(t0, {{"ID", Int64.Type}}),

    // 2) Флаг пустого Anbieter: пусто/null -> 1 (в конец), иначе 0
    t2 = Table.AddColumn(
        t1,
        "Anbieter_IsBlank",
        each if [Anbieter] = null or Text.Trim(Text.From([Anbieter])) = "" then 1 else 0,
        Int64.Type
    ),

    // 3) Сортировка: ID ↑, внутри ID пустые Anbieter в конец, затем Anbieter ↓
    t3 = Table.Sort(
        t2,
        {
            {"ID", Order.Ascending},
            {"Anbieter_IsBlank", Order.Ascending},
            {"Anbieter", Order.Descending}
        }
    ),

    // 4) Удаляем вспомогательный столбец
    t4 = Table.RemoveColumns(t3, {"Anbieter_IsBlank"})
in
    t4
