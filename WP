(txt as nullable text) as text =>
let
    t = if txt = null then "" else txt,
    chars = Text.ToList(t),

    // Собираем цифровые "ранны"; добавляем в результат только если
    // 1) длина >= 4
    // 2) ранн заканчивается прямо перед ПРОБЕЛОМ (т.е. следующий символ = " ")
    state =
        List.Accumulate(
            chars,
            [cur = "", out = {}],
            (s, c) =>
                if c >= "0" and c <= "9" then
                    [cur = s[cur] & c, out = s[out]]
                else
                    // ранн завершился перед символом c (который не цифра)
                    // берём только если c = " "
                    [cur = "",
                     out = if Text.Length(s[cur]) >= 4 and c = " "
                           then s[out] & {s[cur]}
                           else s[out]]
        ),

    // ВАЖНО: если строка закончилась цифрами, мы НЕ добавляем (нет пробела после номера)
    uniq = List.Distinct(state[out]),
    res = Text.Combine(uniq, ";")
in
    res

fxExtractNums4Space([Artikel Bez])
