Option Explicit

' Apply filter when Search button is clicked
Private Sub cmdSearch_Click()
    ApplyGetraenkeFilter Trim(Me.txtSearch.Text)
End Sub

' Copy visible rows (A:E) when Copy button is clicked
Private Sub cmdCopy_Click()
    Dim ws As Worksheet
    Dim rng As Range
    Dim rngVisible As Range
    
    Set ws = ThisWorkbook.Worksheets("Getränke")
    
    ' Whole table based on A1
    Set rng = ws.Range("A1").CurrentRegion
    
    On Error Resume Next
    Set rngVisible = rng.SpecialCells(xlCellTypeVisible)
    On Error GoTo 0
    
    If Not rngVisible Is Nothing Then
        ' Copy only columns A:E of visible rows
        rngVisible.Columns("A:E").Copy
    Else
        MsgBox "Nothing to copy – no visible rows.", vbInformation
    End If
End Sub

' Clear search and show all data
Private Sub cmdClear_Click()
    Me.txtSearch.Text = ""
    ApplyGetraenkeFilter ""
End Sub
