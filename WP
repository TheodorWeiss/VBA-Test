Function PackNorm(ByVal text As String, Optional ByVal index As Variant) As String
    Dim re As Object, matches As Object, m As Object
    Dim cnt As Long, volL As Double, volMl As Long
    Dim effIndex As Long
    
    Set re = CreateObject("VBScript.RegExp")
    With re
        ' Ищем пары "число x число(,число)" с возможными пробелами и L/l
        ' Примеры: 20x0,5L / 24x0,33 l / 4x6x18 / 12 x 1,0 L
        .Pattern = "(\d+)\s*x\s*(\d+(?:[.,]\d+)?)\s*[lL]?"
        .Global = True
        .IgnoreCase = True
    End With
    
    If Not re.Test(text) Then
        PackNorm = ""
        Exit Function
    End If
    
    Set matches = re.Execute(text)
    
    ' Если индекс не задан – берём ПОСЛЕДНЮЮ пару (важно для 4x6x18)
    If IsMissing(index) Then
        effIndex = matches.Count   ' последняя пара
    Else
        effIndex = CLng(index)
        If effIndex < 1 Or effIndex > matches.Count Then
            PackNorm = ""
            Exit Function
        End If
    End If
    
    Set m = matches(effIndex - 1)
    
    ' 1-я подгруппа: количество упаковок/бутылок слева от x
    cnt = CLng(m.SubMatches(0))
    
    ' 2-я подгруппа: литры справа от x (могут быть с запятой или точкой)
    volL = CDbl(Replace(m.SubMatches(1), ",", "."))
    volMl = CLng(volL * 1000)
    
    PackNorm = CStr(cnt) & "x" & CStr(volMl)
End Function
