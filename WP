Function PackNorm(ByVal text As String) As String
    Dim re As Object, matches As Object, m As Object
    Dim cnt As Long
    Dim volRaw As String
    Dim volNum As Double
    Dim volMl As Long
    
    Set re = CreateObject("VBScript.RegExp")
    With re
        ' Ищем ВСЕ пары "число x число(,число)" с возможными пробелами и L/l
        ' Примеры: 20x0,5L / 24x0,33 l / 42x6x0,33 / 12 x 1,0 L
        .Pattern = "(\d+)\s*x\s*(\d+(?:[.,]\d+)?)\s*[lL]?"
        .Global = True
        .IgnoreCase = True
    End With
    
    If Not re.Test(text) Then
        PackNorm = ""
        Exit Function
    End If
    
    ' Берём ПОСЛЕДНЕЕ совпадение (правый литраж)
    Set matches = re.Execute(text)
    Set m = matches(matches.Count - 1)
    
    ' Кол-во слева от x
    cnt = CLng(m.SubMatches(0))
    
    ' Литры справа от x → мл
    volRaw = CStr(m.SubMatches(1))
    volRaw = Replace(volRaw, ",", ".")
    volNum = CDbl(volRaw)
    volMl = CLng(volNum * 1000)   ' всегда литры → мл
    
    PackNorm = CStr(cnt) & "x" & CStr(volMl)
End Function
