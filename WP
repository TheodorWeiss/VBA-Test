Option Explicit

Public Function InsertSpaceLowerUpper(ByVal s As String) As String
    Dim i As Long
    Dim ch As String, prevCh As String
    Dim result As String

    If Len(s) = 0 Then
        InsertSpaceLowerUpper = ""
        Exit Function
    End If

    result = Mid$(s, 1, 1)

    For i = 2 To Len(s)
        ch = Mid$(s, i, 1)
        prevCh = Mid$(s, i - 1, 1)

        ' Если предыдущая буква строчная
        ' и текущая заглавная → вставляем пробел
        If prevCh Like "[a-zäöüß]" And ch Like "[A-ZÄÖÜ]" Then
            result = result & " " & ch
        Else
            result = result & ch
        End If
    Next i

    InsertSpaceLowerUpper = result
End Function
